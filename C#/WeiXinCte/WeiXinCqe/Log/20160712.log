[2016-07-12 10:48:14]    获取数据库DataTable失败SQL语句为: SELECT ID AS SYSID,TO_CHAR(WORK_DAY,'MM-DD') AS WORK_DAY,CLASSWORKTYPE,DINNER_TYPE,DINNER_SMALL_TYPE,TO_CHAR(BEGIN_TIME,'YYYY-MM-DD HH24:MI') AS BEGIN_TIME,TO_CHAR(END_TIME,'YYYY-MM-DD HH24:MI') AS END_TIME,STATUS,FLAG,ISLOCK FROM (SELECT ID,WORK_DAY,STAFFID,(CASE WHEN DINNER_TYPE='1' THEN '早餐'  WHEN DINNER_TYPE='2'  AND CLASSWORKTYPE='白班'  THEN '午餐'  WHEN DINNER_TYPE='2'  AND CLASSWORKTYPE='夜班'  THEN '夜餐'  ELSE '晚餐' END) AS DINNER_TYPE,CLASSWORKTYPE,DINNER_SMALL_TYPE,     (CASE WHEN CLASSWORKTYPE='夜班'  AND DINNER_TYPE='1'  THEN  Y_BEGIN_TIME+1  WHEN CLASSWORKTYPE='夜班'  AND DINNER_TYPE <>'1'  THEN  Y_BEGIN_TIME   ELSE  BEGIN_TIME  END)  AS BEGIN_TIME,  (CASE WHEN CLASSWORKTYPE='夜班'  AND DINNER_TYPE='1'  THEN  Y_END_TIME+1   WHEN CLASSWORKTYPE='夜班'  AND DINNER_TYPE ='2'  THEN  Y_END_TIME+1   WHEN CLASSWORKTYPE='夜班'  AND DINNER_TYPE ='3'  THEN  Y_END_TIME  ELSE  END_TIME  END)  AS END_TIME, (CASE WHEN FLAG ='0' THEN '未就餐' WHEN FLAG ='1' THEN '已就餐'  WHEN FLAG ='1' THEN '人工取消' ELSE '自动取消'  END)  AS STATUS,FLAG ,ISLOCK FROM V_STAFF_DINNER_DETAIL WHERE WORK_DAY>=TO_DATE(TO_CHAR(SYSDATE-1,'YYYY-MM-DD'),'YYYY-MM-DD') AND STAFFID ='071115'  AND FLAG IN ('0','1'))  ORDER BY WORK_DAY  ,BEGIN_TIMEUNION ALL SELECT ID AS SYSID,TO_CHAR(WORK_DAY,'MM-DD') AS WORK_DAY,CLASSWORKTYPE,DINNER_TYPE,DINNER_SMALL_TYPE,TO_CHAR(BEGIN_TIME,'YYYY-MM-DD HH24:MI') AS BEGIN_TIME,TO_CHAR(END_TIME,'YYYY-MM-DD HH24:MI') AS END_TIME,STATUS,FLAG,ISLOCK FROM (SELECT ID,WORK_DAY,STAFFID,(CASE WHEN DINNER_TYPE='1' THEN '早餐'  WHEN DINNER_TYPE='2'  AND CLASSWORKTYPE='白班'  THEN '午餐'  WHEN DINNER_TYPE='2'  AND CLASSWORKTYPE='夜班'  THEN '夜餐'  ELSE '晚餐' END) AS DINNER_TYPE,CLASSWORKTYPE,DINNER_SMALL_TYPE,     (CASE WHEN CLASSWORKTYPE='夜班'  AND DINNER_TYPE='1'  THEN  Y_BEGIN_TIME+1  WHEN CLASSWORKTYPE='夜班'  AND DINNER_TYPE <>'1'  THEN  Y_BEGIN_TIME   ELSE  BEGIN_TIME  END)  AS BEGIN_TIME,  (CASE WHEN CLASSWORKTYPE='夜班'  AND DINNER_TYPE='1'  THEN  Y_END_TIME+1   WHEN CLASSWORKTYPE='夜班'  AND DINNER_TYPE ='2'  THEN  Y_END_TIME+1   WHEN CLASSWORKTYPE='夜班'  AND DINNER_TYPE ='3'  THEN  Y_END_TIME  ELSE  END_TIME  END)  AS END_TIME, (CASE WHEN FLAG ='0' THEN '未就餐' WHEN FLAG ='1' THEN '已就餐'  WHEN FLAG ='1' THEN '人工取消' ELSE '自动取消'  END)  AS STATUS,FLAG ,ISLOCK FROM V_STAFF_DINNER_DETAIL WHERE WORK_DAY>=TO_DATE(TO_CHAR(SYSDATE-1,'YYYY-MM-DD'),'YYYY-MM-DD') AND STAFFID ='092156'  AND FLAG IN ('0','1'))  ORDER BY WORK_DAY  ,BEGIN_TIME错误原因:System.Data.OracleClient.OracleException (0x80131938): ORA-00933: SQL 命令未正确结束

   在 System.Data.OracleClient.OracleConnection.CheckError(OciErrorHandle errorHandle, Int32 rc)
   在 System.Data.OracleClient.OracleCommand.Execute(OciStatementHandle statementHandle, CommandBehavior behavior, Boolean needRowid, OciRowidDescriptor& rowidDescriptor, ArrayList& resultParameterOrdinals)
   在 System.Data.OracleClient.OracleCommand.Execute(OciStatementHandle statementHandle, CommandBehavior behavior, ArrayList& resultParameterOrdinals)
   在 System.Data.OracleClient.OracleCommand.ExecuteReader(CommandBehavior behavior)
   在 System.Data.OracleClient.OracleCommand.ExecuteDbDataReader(CommandBehavior behavior)
   在 System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   在 System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   在 System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   在 System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   在 WeiXinCqe.OracleOperateHelp.ExecuteDataTable(String connectionString, CommandType cmdType, String cmdText, OracleParameter[] commandParameters) 位置 C:\Users\cqe092156\documents\visual studio 2010\Projects\WeiXinCqe\WeiXinCqe\class\OracleOperateHelp.cs:行号 106
   在 WeiXinCqe.OracleOperateHelp.getDataTable(String sql) 位置 C:\Users\cqe092156\documents\visual studio 2010\Projects\WeiXinCqe\WeiXinCqe\class\OracleOperateHelp.cs:行号 53

[2016-07-12 10:49:24]    获取数据库DataTable失败SQL语句为: SELECT ID AS SYSID,TO_CHAR(WORK_DAY,'MM-DD') AS WORK_DAY,CLASSWORKTYPE,DINNER_TYPE,DINNER_SMALL_TYPE,TO_CHAR(BEGIN_TIME,'YYYY-MM-DD HH24:MI') AS BEGIN_TIME,TO_CHAR(END_TIME,'YYYY-MM-DD HH24:MI') AS END_TIME,STATUS,FLAG,ISLOCK FROM (SELECT ID,WORK_DAY,STAFFID,(CASE WHEN DINNER_TYPE='1' THEN '早餐'  WHEN DINNER_TYPE='2'  AND CLASSWORKTYPE='白班'  THEN '午餐'  WHEN DINNER_TYPE='2'  AND CLASSWORKTYPE='夜班'  THEN '夜餐'  ELSE '晚餐' END) AS DINNER_TYPE,CLASSWORKTYPE,DINNER_SMALL_TYPE,     (CASE WHEN CLASSWORKTYPE='夜班'  AND DINNER_TYPE='1'  THEN  Y_BEGIN_TIME+1  WHEN CLASSWORKTYPE='夜班'  AND DINNER_TYPE <>'1'  THEN  Y_BEGIN_TIME   ELSE  BEGIN_TIME  END)  AS BEGIN_TIME,  (CASE WHEN CLASSWORKTYPE='夜班'  AND DINNER_TYPE='1'  THEN  Y_END_TIME+1   WHEN CLASSWORKTYPE='夜班'  AND DINNER_TYPE ='2'  THEN  Y_END_TIME+1   WHEN CLASSWORKTYPE='夜班'  AND DINNER_TYPE ='3'  THEN  Y_END_TIME  ELSE  END_TIME  END)  AS END_TIME, (CASE WHEN FLAG ='0' THEN '未就餐' WHEN FLAG ='1' THEN '已就餐'  WHEN FLAG ='1' THEN '人工取消' ELSE '自动取消'  END)  AS STATUS,FLAG ,ISLOCK FROM V_STAFF_DINNER_DETAIL WHERE WORK_DAY>=TO_DATE(TO_CHAR(SYSDATE-1,'YYYY-MM-DD'),'YYYY-MM-DD') AND STAFFID ='071115'  AND FLAG IN ('0','1'))  ORDER BY WORK_DAY  ,BEGIN_TIMEUNION ALL SELECT ID AS SYSID,TO_CHAR(WORK_DAY,'MM-DD') AS WORK_DAY,CLASSWORKTYPE,DINNER_TYPE,DINNER_SMALL_TYPE,TO_CHAR(BEGIN_TIME,'YYYY-MM-DD HH24:MI') AS BEGIN_TIME,TO_CHAR(END_TIME,'YYYY-MM-DD HH24:MI') AS END_TIME,STATUS,FLAG,ISLOCK FROM (SELECT ID,WORK_DAY,STAFFID,(CASE WHEN DINNER_TYPE='1' THEN '早餐'  WHEN DINNER_TYPE='2'  AND CLASSWORKTYPE='白班'  THEN '午餐'  WHEN DINNER_TYPE='2'  AND CLASSWORKTYPE='夜班'  THEN '夜餐'  ELSE '晚餐' END) AS DINNER_TYPE,CLASSWORKTYPE,DINNER_SMALL_TYPE,     (CASE WHEN CLASSWORKTYPE='夜班'  AND DINNER_TYPE='1'  THEN  Y_BEGIN_TIME+1  WHEN CLASSWORKTYPE='夜班'  AND DINNER_TYPE <>'1'  THEN  Y_BEGIN_TIME   ELSE  BEGIN_TIME  END)  AS BEGIN_TIME,  (CASE WHEN CLASSWORKTYPE='夜班'  AND DINNER_TYPE='1'  THEN  Y_END_TIME+1   WHEN CLASSWORKTYPE='夜班'  AND DINNER_TYPE ='2'  THEN  Y_END_TIME+1   WHEN CLASSWORKTYPE='夜班'  AND DINNER_TYPE ='3'  THEN  Y_END_TIME  ELSE  END_TIME  END)  AS END_TIME, (CASE WHEN FLAG ='0' THEN '未就餐' WHEN FLAG ='1' THEN '已就餐'  WHEN FLAG ='1' THEN '人工取消' ELSE '自动取消'  END)  AS STATUS,FLAG ,ISLOCK FROM V_STAFF_DINNER_DETAIL WHERE WORK_DAY>=TO_DATE(TO_CHAR(SYSDATE-1,'YYYY-MM-DD'),'YYYY-MM-DD') AND STAFFID ='092156'  AND FLAG IN ('0','1'))  ORDER BY WORK_DAY  ,BEGIN_TIME错误原因:System.Data.OracleClient.OracleException (0x80131938): ORA-00933: SQL 命令未正确结束

   在 System.Data.OracleClient.OracleConnection.CheckError(OciErrorHandle errorHandle, Int32 rc)
   在 System.Data.OracleClient.OracleCommand.Execute(OciStatementHandle statementHandle, CommandBehavior behavior, Boolean needRowid, OciRowidDescriptor& rowidDescriptor, ArrayList& resultParameterOrdinals)
   在 System.Data.OracleClient.OracleCommand.Execute(OciStatementHandle statementHandle, CommandBehavior behavior, ArrayList& resultParameterOrdinals)
   在 System.Data.OracleClient.OracleCommand.ExecuteReader(CommandBehavior behavior)
   在 System.Data.OracleClient.OracleCommand.ExecuteDbDataReader(CommandBehavior behavior)
   在 System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   在 System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   在 System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   在 System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   在 WeiXinCqe.OracleOperateHelp.ExecuteDataTable(String connectionString, CommandType cmdType, String cmdText, OracleParameter[] commandParameters) 位置 C:\Users\cqe092156\documents\visual studio 2010\Projects\WeiXinCqe\WeiXinCqe\class\OracleOperateHelp.cs:行号 106
   在 WeiXinCqe.OracleOperateHelp.getDataTable(String sql) 位置 C:\Users\cqe092156\documents\visual studio 2010\Projects\WeiXinCqe\WeiXinCqe\class\OracleOperateHelp.cs:行号 53

