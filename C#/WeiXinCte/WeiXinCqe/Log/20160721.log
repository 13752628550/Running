[2016-07-21 13:58:33]    获取数据库DataTable失败SQL语句为:1SELECT STAFFID,STAFFNAME,ON_DUTY,OFF_DUTY,PUBLIC_LEAVE,BACK1,BACK4,CJ,(SICK_LEAVE+SICK_LEAVE_180) AS SICK_LEAVE,HOUSE_PAY_COUNT,(MORNING+OVERTIME_MORNING+OVERTIME_XL_MORNING) AS MORNING,(MIDDLE+OVERTIME_MIDDLE+OVERTIME_XL_MIDDLE) AS MIDDLE,(NIGHT+OVERTIME_NIGHT+OVERTIME_XL_NIGHT) AS NIGHT, (OVERTIME1+OVERTIME1_XL) AS OVERTIME1,(OVERTIME2+OVERTIME2_XL) AS OVERTIME2,(OVERTIME3+OVERTIME3_XL) AS OVERTIME3 FROM STAFF_KQ WHERE YYYYMM='2016-06'  AND STAFFID ='092156'   UNION ALL  SELECT STAFFID,STAFFNAME,ON_DUTY,OFF_DUTY,PUBLIC_LEAVE,BACK1,BACK4,CJ,(SICK_LEAVE+SICK_LEAVE_180) AS SICK_LEAVE,HOUSE_PAY_COUNT,(MORNING+OVERTIME_MORNING+OVERTIME_XL_MORNING) AS MORNING,(MIDDLE+OVERTIME_MIDDLE+OVERTIME_XL_MIDDLE) AS MIDDLE,(NIGHT+OVERTIME_NIGHT+OVERTIME_XL_NIGHT) AS NIGHT, (OVERTIME1+OVERTIME1_XL) AS OVERTIME1,(OVERTIME2+OVERTIME2_XL) AS OVERTIME2,(OVERTIME3+OVERTIME3_XL) AS OVERTIME3 FROM STAFF_KQ WHERE YYYYMM='2016-06'  AND STAFFID ='961879'  AND YYYYMM NOT IN (SELECT YYYYMM FROM STAFF_KQ WHERE YYYYMM='2016-06' AND STAFFID ='092156') 错误原因:System.Data.OracleClient.OracleException (0x80131938): ORA-00900: 无效 SQL 语句

   在 System.Data.OracleClient.OracleConnection.CheckError(OciErrorHandle errorHandle, Int32 rc)
   在 System.Data.OracleClient.OracleCommand.Execute(OciStatementHandle statementHandle, CommandBehavior behavior, Boolean needRowid, OciRowidDescriptor& rowidDescriptor, ArrayList& resultParameterOrdinals)
   在 System.Data.OracleClient.OracleCommand.Execute(OciStatementHandle statementHandle, CommandBehavior behavior, ArrayList& resultParameterOrdinals)
   在 System.Data.OracleClient.OracleCommand.ExecuteReader(CommandBehavior behavior)
   在 System.Data.OracleClient.OracleCommand.ExecuteDbDataReader(CommandBehavior behavior)
   在 System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   在 System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   在 System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   在 System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   在 WeiXinCqe.OracleOperateHelp.ExecuteDataTable(String connectionString, CommandType cmdType, String cmdText, OracleParameter[] commandParameters) 位置 C:\Users\cqe092156\documents\visual studio 2010\Projects\WeiXinCqe\WeiXinCqe\class\OracleOperateHelp.cs:行号 106
   在 WeiXinCqe.OracleOperateHelp.getDataTable(String sql) 位置 C:\Users\cqe092156\documents\visual studio 2010\Projects\WeiXinCqe\WeiXinCqe\class\OracleOperateHelp.cs:行号 53

[2016-07-21 16:41:28]    获取数据库DataTable失败SQL语句为:SELECT   TO_CHAR(RECORDDATE,'YYYY-MM-DD') AS RECORDDATE,STAFFID,STAFFNAME,((CASE CLASSWORKMAKER WHEN N'R' THEN '休息' ELSE '出勤' END)||'('||CLASSWORKTYPE||')') AS CLASSWORKTYPE,DUTYSTATUS  FROM STAFF_KQ_DETAIL_BAK  WHERE  YYYYMM ='2016-06' AND STAFFID = '061428'   AND  CLASSWORKMAKER  !='R'  AND (  DUTYMAKER IS NULL   OR DUTYMAKER ='HD' OR DUTYMAKER  ='CQJC' )  ORDER BY   TO_CHAR(RECORDDATE,'YYYY-MM-DD') AS RECORDDATE错误原因:System.Data.OracleClient.OracleException (0x80131938): ORA-00933: SQL 命令未正确结束

   在 System.Data.OracleClient.OracleConnection.CheckError(OciErrorHandle errorHandle, Int32 rc)
   在 System.Data.OracleClient.OracleCommand.Execute(OciStatementHandle statementHandle, CommandBehavior behavior, Boolean needRowid, OciRowidDescriptor& rowidDescriptor, ArrayList& resultParameterOrdinals)
   在 System.Data.OracleClient.OracleCommand.Execute(OciStatementHandle statementHandle, CommandBehavior behavior, ArrayList& resultParameterOrdinals)
   在 System.Data.OracleClient.OracleCommand.ExecuteReader(CommandBehavior behavior)
   在 System.Data.OracleClient.OracleCommand.ExecuteDbDataReader(CommandBehavior behavior)
   在 System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   在 System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   在 System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   在 System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   在 WeiXinCqe.OracleOperateHelp.ExecuteDataTable(String connectionString, CommandType cmdType, String cmdText, OracleParameter[] commandParameters) 位置 C:\Users\cqe092156\documents\visual studio 2010\Projects\WeiXinCqe\WeiXinCqe\class\OracleOperateHelp.cs:行号 106
   在 WeiXinCqe.OracleOperateHelp.getDataTable(String sql) 位置 C:\Users\cqe092156\documents\visual studio 2010\Projects\WeiXinCqe\WeiXinCqe\class\OracleOperateHelp.cs:行号 53

[2016-07-21 16:42:18]    获取数据库DataTable失败SQL语句为:SELECT   TO_CHAR(RECORDDATE,'YYYY-MM-DD') AS RECORDDATE,STAFFID,STAFFNAME,((CASE CLASSWORKMAKER WHEN N'R' THEN '休息' ELSE '出勤' END)||'('||CLASSWORKTYPE||')') AS CLASSWORKTYPE,DUTYSTATUS  FROM STAFF_KQ_DETAIL_BAK  WHERE  YYYYMM ='2016-06' AND STAFFID = '061428'   AND  CLASSWORKMAKER  !='R'  AND (  DUTYMAKER IS NULL   OR DUTYMAKER ='HD' OR DUTYMAKER  ='CQJC' )  ORDER BY   TO_CHAR(RECORDDATE,'YYYY-MM-DD') AS RECORDDATE错误原因:System.Data.OracleClient.OracleException (0x80131938): ORA-00933: SQL 命令未正确结束

   在 System.Data.OracleClient.OracleConnection.CheckError(OciErrorHandle errorHandle, Int32 rc)
   在 System.Data.OracleClient.OracleCommand.Execute(OciStatementHandle statementHandle, CommandBehavior behavior, Boolean needRowid, OciRowidDescriptor& rowidDescriptor, ArrayList& resultParameterOrdinals)
   在 System.Data.OracleClient.OracleCommand.Execute(OciStatementHandle statementHandle, CommandBehavior behavior, ArrayList& resultParameterOrdinals)
   在 System.Data.OracleClient.OracleCommand.ExecuteReader(CommandBehavior behavior)
   在 System.Data.OracleClient.OracleCommand.ExecuteDbDataReader(CommandBehavior behavior)
   在 System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   在 System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   在 System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   在 System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   在 WeiXinCqe.OracleOperateHelp.ExecuteDataTable(String connectionString, CommandType cmdType, String cmdText, OracleParameter[] commandParameters) 位置 C:\Users\cqe092156\documents\visual studio 2010\Projects\WeiXinCqe\WeiXinCqe\class\OracleOperateHelp.cs:行号 106
   在 WeiXinCqe.OracleOperateHelp.getDataTable(String sql) 位置 C:\Users\cqe092156\documents\visual studio 2010\Projects\WeiXinCqe\WeiXinCqe\class\OracleOperateHelp.cs:行号 53

