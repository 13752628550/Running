Func _LanDateObtain($Controls)
;======================================================
;函数名称:       _LanDateObtain($Controls)
; 详细信息:        将网卡的名称，ID，MACADDRESS 写入$Controls
;DIM $LanZS 将网卡张数写入到GUI中以便需要时调用！
; 作者:      viplight (viplight@qq.com)
; QQ: 530417369
;======================================================
;>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>WMI查找活动网卡
$wbemFlagReturnImmediately = 0x10
$wbemFlagForwardOnly = 0x20
$colItems = ""
$nextitems=""
dim $NCSettingID[5],$NetConnectionID[5],$NCName[5],$NCMACAddress[5],$NCSettingIDX,$i=0
$strComputer = "localhost"
$objWMIService = ObjGet("winmgmts:\\" & $strComputer & "\root\CIMV2")
$colItems = $objWMIService.ExecQuery ("SELECT * FROM Win32_NetworkAdapterConfiguration WHERE IPEnabled=True", "WQL", $wbemFlagReturnImmediately + $wbemFlagForwardOnly)
If IsObj($colItems) Then
        For $objItem In $colItems
                if $objItem.SettingID="" then ContinueLoop
                if $objItem.Description="Microsoft TV/Video Connection" then ContinueLoop
                $index=$objItem.index
                $nextitems=$objWMIService.ExecQuery ("SELECT * FROM Win32_NetworkAdapter WHERE Index="&$index, "WQL")
                for $objItem2 in $nextitems
                        $NCName[$i]=$objItem2.Name
                        $NetConnectionID[$i]=$objItem2.NetConnectionID
                        if $objItem2.NetConnectionID == "" then ContinueLoop
                        $NCMACAddress[$i] = $objItem2.MACAddress
                        $NCSettingID[$i] = $objItem.SettingID
                        $NCSettingIDX=$NCSettingIDX&$NCName[$i]&","&$NCSettingID[$i]&","&$NCMACAddress[$i]&","&$index&"|"
                        $i=$i+1
                Next
        Next
EndIf ;<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<WMI查找活动网卡
GUICtrlSetData($Controls,$NCSettingIDX,$NCName[0]&","&$NCSettingID[0]&","&$NCMACAddress[0]&","&$index)
$LanZS = GUICtrlCreateLabel($i,1,1)
GUICtrlSetState($LanZS,$GUI_HIDE)
EndFunc

Func _SetCmpNameAndIP($LanID,$strComputerName,$setIP,$setZW,$setWG,$setDNS)
;======================================================
; 函数名称:       _SetCmpNameAndIP($AdapterID,$strComputerName,$setIP,$setZW,$setWG,$setDNS)
; 详细信息:        修改机器IP,和机器名
; $LanID 网卡ID
; $strComputerName 计算机名
; $setIP 机器IP
; $setZW 子网掩码
; $setWG 默认网关
; $setDNS DNS
; 作者:      viplight (viplight@qq.com)
; QQ: 530417369
;======================================================
$SetKey1 = "HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\"
$SetKey2 = "HKEY_LOCAL_MACHINE\SYSTEM\ControlSet002\"
$CtrlKey = "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\"
$LanReg1 = $SetKey1 & "Services\Tcpip\Parameters\Interfaces\" & $LanID
$LanReg2 = $SetKey2 & "Services\Tcpip\Parameters\Interfaces\" & $LanID
$LanReg3 = $CtrlKey & "Services\Tcpip\Parameters\Interfaces\" & $LanID

;通过注册表修改网卡自动获取IP为固定IP
RegWrite($LanReg3,"EnableDHCP","REG_DWORD","0")
;▲通过注册表修改网卡自动获取IP为固定IP

;通过注册表修改计算机名
RegWrite ($SetKey1 & "Services\Tcpip\Parameters", "NV Hostname", "REG_SZ", $strComputerName)
RegWrite ($SetKey1 & "Services\Tcpip\Parameters", "Hostname", "REG_SZ", $strComputerName)
RegWrite ($CtrlKey & "Control\ComputerName\ComputerName", "ComputerName", "REG_SZ", $strComputerName)
RegWrite ($CtrlKey & "Services\Tcpip\Parameters", "NV Hostname", "REG_SZ", $strComputerName)
RegWrite ($CtrlKey & "Services\Tcpip\Parameters", "Hostname", "REG_SZ", $strComputerName)
;▲通过注册表修改计算机名

;通过注册表修改IP
RegWrite($LanReg1,"IPAddress","REG_MULTI_SZ",$setIP)
RegWrite($LanReg2,"IPAddress","REG_MULTI_SZ",$setIP)
RegWrite($LanReg3,"IPAddress","REG_MULTI_SZ",$setIP)
;▲通过注册表修改IP

;通过注册表修改子网掩码
RegWrite($LanReg1,"SubnetMask","REG_MULTI_SZ",$setZW)
RegWrite($LanReg2,"SubnetMask","REG_MULTI_SZ",$setZW)
RegWrite($LanReg3,"SubnetMask","REG_MULTI_SZ",$setZW)
;▲通过注册表修改子网掩码

;通过注册表修改网关
RegWrite($LanReg1,"DefaultGateway","REG_MULTI_SZ",$setWG)
RegWrite($LanReg2,"DefaultGateway","REG_MULTI_SZ",$setWG)
RegWrite($LanReg3,"DefaultGateway","REG_MULTI_SZ",$setWG)
;▲通过注册表修改网关

;通过注册表修改DNS
RegWrite($LanReg1,"NameServer","REG_SZ",$setDNS)
RegWrite($LanReg2,"NameServer","REG_SZ",$setDNS)
RegWrite($LanReg3,"NameServer","REG_SZ",$setDNS)
;▲通过注册表修改DNS
EndFunc   ;==>_SetCmpNameAndIP

Func _cscdk($BenJiBH)
;======================================================
; 函数名称:     _cscdk($BenJiBH)
; 详细信息:     修改机器的CS序列号
;$BenJiBH  为当前编号
; 作者:      viplight (viplight@qq.com)
; QQ: 530417369
;======================================================
        If $BenJiBH < 255 And $BenJiBH > 0 Then
                $cscdkey="197756082776820913226078452298968563104229362060480131995471018472395626620868229142562486422973246468605692438065881239992942486831986471428223290343195800579153207888231923411228813296148120849239882940282633976461958023799865089843329164419280433954451598415596230082889239302661485672827267150716965198320844059063834998548879203088556224273676938023407070167268291334629991514397024359033811450429591800978378635695926015450316062011896411900964756878359933291311269698505611778538097583642111724559521057833216640257352579586657914860615387406360642191734198300765127381489152175162843181707728765528034078856983770314753035867518151745601173167322581102730071996555270756207980819133185381184427868045733575498699609833696915151587317127206638857093014335463825817471724979794664279751439260725544359956746016428059065135347117141709859475499802054656116348085369737399232658223354655249230120451417834181447117329718451579776433820653692206472674048520626365487067597491968960872029605474288240504759069059305077632047106948889616069655746791606961097210777379375562437695898414073778833444143410059886439753223522855506549272183771208703759393532088326908182312005841186807373868660023179415036075966941503478496392680179284472554301377411619970919380565956900644348764101331054869569960224939535144044096308441865835543891803264035674852904668052441431786866728332519974291666586743449837719660204460328672720446009966230845584423189212025140475633231090090728816344011108488920329093049475957346086416372973209401024204817628683943477916929222730971307679911180516030784694475211021351684327445962448171798707950325797141343672176000152140029744851855924774044485275463939454363216867600255743978180084757739429960168957673900155632724867497405425488598353925344680042277281783350106431629522813513736627000663665081760254864190655298849828102175716098878717442838019777763516491152542581013131611979499174765486909556078336075348841845627216662089170346031201947440174300602970260432810901736874960332426435919294386314821543256917590043832078055169291991180695745801781955305698953832755815671512518597586587153180923359798487926563404698359705526677723387963627985668027625890316516985402221244430373281606791541225448507061402510865564750604958320282086199699222322346643202281001016880186300658795730430896793635680589872304262147354733449138935165290648153358505905152702603382152922686022630301884530032711422571297117692184629794837152604595073731674235870189643837189589159623471333349416517707009760968075875894789282252721387070615900921435174059613493699667340697592660389623569917090176637193399192429885611735628383118499828718836394540499156580103126754738267351258269865563874629145570165205201939075592702345946026500040840323582579488650504143540349560557228911645765812923357220068457014279490512953597800766160464649602308958571172827267150716965198320844059063834998548879203088556224273676938023407070167268291334629991514397024359033811450429591800978378635695926015450316062011896411900964756878359933291311269698505611778538097583642111724559521057833216640257352579586657914860615387406360642191734198300765127381489152175162843181707728765528034078856983770314753035867518151745601173167322581102730071996555270756207980819133185381184427868045733575427248674974051013131611979"
                $start= $BenJiBH*13-12
                $dy = StringMid($cscdkey,$start,13)
                RegWrite("HKCU\Software\Valve\CounterStrike\Settings","Key","REG_SZ",$dy)
        EndIf
EndFunc

Func _SetIPX($IPX)
;======================================================
; 函数名称:      _SetIPX($IPX)
; 详细信息:        修改机器的IPX协议
; 作者:      viplight (viplight@qq.com)
; QQ: 530417369
;======================================================
RegWrite("HKLM\SYSTEM\CurrentControlSet\Services\NwlnkIpx\Parameters", "VirtualNetworkNumber", "REG_DWORD","0x"&$IPX)
Endfunc